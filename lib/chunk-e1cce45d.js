import{a as e,b as n}from"./chunk-2d0907d4.js";const tt=function(t){t||(t=window.location.href);const e=t.split("?");if(2!==e.length)return{};const s=e[1].split("&");let i={};return s.forEach(t=>{const e=t.split("=");let s=e[1];"true"===s&&(s=!0),"false"===s&&(s=!1),function(t){return e=t,!Number.isNaN(e)&&!isNaN(e)&&Number.isFinite(parseFloat(t));var e}(s)&&(s=parseFloat(s)),i[e[0]]=s}),i},et=()=>{const t=window.navigator,e=["language","browserLanguage","userLanguage","systemLanguage"];if(Array.isArray(t.languages)&&t.languages.length>0)return t.languages[0].substr(0,2);for(let s=0,i=e.length;i>s;s++){const i=t[e[s]];if(i)return i.substr(0,2)}return"en"};class f{static init(t={}){const{locale:e,kernelInstance:s,kernelContainer:i,planObjectId:n}=t;f.kernelInstance=s,f.kernelContainer=i,f.planObjectId=n,f.actualLocale=e||et()}}f.actualLocale="en",f.useHDGeometry=!1,f.kernelInstance=null,f.kernelContainer=null,f.planObjectId=null;const st={PRIMARY:"#db0000",ON_PRIMARY:"#ffffff",DEFAULT_BACKGROUND:"#f9fafc",SELECTION:"#ffffff"},o=t=>{document.body.style.cursor=t},d=t=>{const e=t.headers.get("content-type");if(e&&e.includes("application/json"))return t.json();throw new TypeError("No JSON returned")},u=()=>window.__RML__ENV__?window.__RML__ENV__.initData.colors:st,i=()=>window.__RML__ENV__&&window.__RML__ENV__.assetPath?window.__RML__ENV__.assetPath:"";class I{_setupCommonGlobals(){window.__RML__DEBUG__||(window.__RML__DEBUG__={}),window.__RML__ENV__||(window.__RML__ENV__={},window.__RML__ENV__.assetPath||(window.__RML__ENV__.assetPath=""));const t={retina:!1,overrideCountry:null,locale:f.actualLocale,unit:null,unitStringType:null,dls:null,ls:null,meshSelection:!0,colors:st,enableHSC:!1,mode:"3D",stats:!1};window.__RML__ENV__.initData?window.__RML__ENV__.initData=Object.assign(t,window.__RML__ENV__.initData):window.__RML__ENV__.initData=t;const e=tt();window.__RML__ENV__.initData=Object.assign(window.__RML__ENV__.initData,e)}_setupCommonDependencies(){}_cleanUpCommonGlobals(){window.__RML__DEBUG__&&(window.__RML__DEBUG__.Kernel&&window.__RML__DEBUG__.Kernel.clearAll&&window.__RML__DEBUG__.Kernel.clearAll(),delete window.__RML__DEBUG__),delete window.__RML__ENV__;for(const t in window.THREE)if(window.THREE.hasOwnProperty(t))try{delete window.THREE[t]}catch(t){console.error(t)}window.THREE=void 0}_cleanUpCommonDependencies(){}boot(t){this._setupCommonGlobals(),this.setupGlobals(t),this._setupCommonDependencies(),this.setupDependencies(),this.bootFinished()}lookup(t){return window.__RML__DI__.lookup(t)}teardown(){this.cleanUpDependencies(),this._cleanUpCommonDependencies(),this.cleanUpGlobals(),this._cleanUpCommonGlobals(),window.__RML__DI__&&delete window.__RML__DI__}resetDom(){this.lookup("dom-helper").reset()}}const w={HSC:"rml-hsc",HSP:"rml-hsp",GLB:"rml-glb"};class y{get element(){return this._element}get canvas(){return this._canvas}set canvas(t){this._canvas=t}setDomElement(t){if(!this._container){this._container=document.createElement("div");const e="rml-threejs-canvas-container";this._container.classList.add(e),this._container.style.position="relative",this._container.style.width="100%",this._container.style.height="100%";const s=document.createElement("style");s.innerText="."+e+" canvas{position:absolute;top:0;left:0;right:0;bottom:0;}."+e+" .foreground{z-index:100; opacity:1;}."+e+" .background{z-index:-1; opacity:0;}",this._container.appendChild(s),t.appendChild(this._container)}this._element=this._container,this._setClientDimensions(t),this._resizeListener=(()=>this._setClientDimensions(t)),window.addEventListener("resize",this._resizeListener)}_setClientDimensions({clientWidth:t,clientHeight:e}){this._width=t,this._height=e}getClientDimensions(){return new THREE.Vector2(this._width,this._height)}cleanUp(){if(this._element){const t=this._element.cloneNode();this._element.parentElement.replaceChild(t,this._element)}}reset(){this.cleanUp(),this._element=null,this._canvas=null,this._container=null,window.removeEventListener("resize",this._resizeListener)}}class r{constructor(){this._listeners={}}_addEventListener(t,e,s){this._listeners[t]||(this._listeners[t]=[]),this._listeners[t].push({callback:e,scope:s})}addEventListener(t,e,s){this._addEventListener(t,e,s)}dispatchEvent(t,e){if(!this._listeners[t])return;const s=this._listeners[t];let i=s.length;for(let t=0;i>t;t++){const i=s[t];i.callback.apply(i.scope,[e])}}removeEventListener(t,e){const s=this._listeners[t];if(s)for(let t=0,i=s.length;i>t;t++)if(s[t].callback===e)return void s.splice(t,1)}}const E=function(t){return t*(Math.PI/180)},it=function(t,e,s,i,n,a){let o=Math.tan(i*(2*Math.PI/360)/2),r=s/2,h=e/2/o+r,_=t/2/(n/a)/o+r;return Math.max(h,_)},nt=function(t){return Math.round(1e3*t)/1e3},at=function(t,e){return Math.abs(t.y-e.y)+Math.abs(t.x-e.x)},b=.6,ot=.4,g="#DDDDDD",rt=1,ht=.5,a=(t,e,s,i)=>{if(!t||!e||0===s||0===i)return new THREE.Vector3;let n=t.clone(),a=s/2,o=i/2;return n.project(e),n.x=n.x*a+a,n.y=-n.y*o+o,n.z=0,n},s=(t,e)=>{e||(e=new THREE.Vector3(0,0,0));let s=new THREE.Vector3(t.size.x/1e3,t.size.z/1e3,t.size.y/1e3),i=new THREE.Vector3(t.origin.x/1e3,t.origin.z/1e3,t.origin.y/-1e3),n=new THREE.Vector3(0,0,-s.z).add(i).sub(e),a=new THREE.Vector3(s.x,s.y,0).add(i).add(e);return new THREE.Box3(n,a)},c=(t,e,s)=>{t.castShadow=s,t.receiveShadow=e,t.children.forEach(t=>{c(t,e,s)})},_t=(t,e)=>{let s=nt(t.x),i=nt(t.y),n=nt(t.z),a=nt(e.x),o=nt(e.y),r=nt(e.z);return s===a&&i===o&&n===r},lt=(t,e)=>{let s=nt(t.w),i=nt(t.x),n=nt(t.y),a=nt(t.z),o=nt(e.w),r=nt(e.x),h=nt(e.y),_=nt(e.z);return s===o&&i===r&&n===h&&a===_},ct=(t,e)=>{let s=nt(t.x),i=nt(t.y),n=nt(e.x),a=nt(e.y);return s===n&&i===a},p=(t,e)=>{let s=new THREE.MeshPhysicalMaterial({metalness:t.shading.metallic,reflectivity:t.shading.specularity||.5,roughness:t.shading.roughness||.5,color:"rgb("+Math.round(100*t.shading.basecolor.r)+"%, "+Math.round(100*t.shading.basecolor.g)+"%, "+Math.round(100*t.shading.basecolor.b)+"%)",transparent:1>t.shading.alpha,opacity:t.shading.alpha,depthWrite:t.shading.alpha>=1});return e&&(s.envMap=e),s},_=(t,e,s,i,n,a)=>new Promise((o,r)=>{(new THREE.TextureLoader).load(t,t=>{t.anisotropy=i,t.wrapS=THREE.RepeatWrapping,t.wrapT=THREE.RepeatWrapping,t.repeat.set(n,a),"XYZ"===e.mapping?s.normalMap=t:s.map=t,"RGBA"===e.mapping&&(s.transparent=!0,s.alphaTest=.5),o()},r)}),l=()=>(window.__RML_GUI__||(window.__RML_GUI__=new dat.GUI),window.__RML_GUI__),dt=(t,e,s=!0)=>{let i=t.getWorldDirection(new THREE.Vector3),n=Math.abs(i.y);.5>n&&!e.transparent&&ut(e,!0,s),n>.5&&e.transparent&&ut(e,!1,s)},ut=(t,e,s=!0)=>{if(!t.userData.tween)if(e)if(t.transparent=!0,s){let e={opacity:1};t.userData.tween=!0,new TWEEN.Tween(e).to({opacity:.2},400).easing(TWEEN.Easing.Sinusoidal.In).onUpdate(()=>{t.opacity=e.opacity}).onComplete(()=>{t.userData.tween=!1}).start()}else t.opacity=.2;else if(s){let e={opacity:.2};t.userData.tween=!0,new TWEEN.Tween(e).to({opacity:1},400).easing(TWEEN.Easing.Sinusoidal.In).onUpdate(()=>{t.opacity=e.opacity}).onComplete(()=>{t.transparent=!1,t.userData.tween=!1}).start()}else t.opacity=1,t.transparent=!1},pt=t=>{let e=new THREE.Color;return e.setRGB((t>>16)/255,(t>>8&255)/255,(t>>0&255)/255),e},gt=t=>{t.traverse(t=>{if(t instanceof THREE.Mesh){let e=t.material;if(0===e.opacity)return;let s={opacity:0,transparent:!0},i={opacity:e.opacity,transparent:e.transparent};e.transparent=s.transparent,e.opacity=s.opacity,new TWEEN.Tween(s).to(i,500).easing(TWEEN.Easing.Linear.None).onUpdate(()=>{e.opacity=s.opacity}).onComplete(()=>{e.transparent=i.transparent}).start()}})},mt=(t,e)=>{t.traverse(s=>{if(s instanceof THREE.Mesh){let i=s.material;if(0===i.opacity)return;let n={opacity:i.opacity,transparent:i.transparent},a={opacity:0,transparent:!0};i.transparent=!0,i.opacity=n.opacity,new TWEEN.Tween(n).to(a,500).easing(TWEEN.Easing.Linear.None).onUpdate(()=>{i.opacity=n.opacity}).onComplete(()=>{i.transparent=a.transparent,e&&e.remove(t)}).start()}})},wt=(t,e)=>{let s=(new THREE.Box3).setFromObject(t),i=s.getSize(new THREE.Vector3),n=Math.min(i.x,i.y,i.z),a=!0;return n>5&&(console.warn("GLB seems to be too big ("+n+")",e),a=!1),-.01>s.min.y&&(console.warn("GLB seems to be under the floor ("+s.min.y+"): ",e),a=!1),a},Et=t=>{"Mesh"===t.type?ft(t):yt(t)},yt=t=>{t&&t.children&&0!==t.children.length&&t.children.forEach(t=>{ft(t)})},ft=t=>{t&&(t.material&&Tt(t.material),t.geometry&&t.geometry.dispose())},Tt=t=>{t&&(t.map&&t.map.dispose(),t.normalMap&&t.normalMap.dispose(),t.dispose())};let vt;const Pt=()=>(vt||((vt=new THREE.MeshBasicMaterial).visible=!1),vt),Rt=-1;class T extends r{constructor(t,e){super(),this._tweenEnd=null,this._pitch=E(10),this._yaw=E(-15),this._distance=Rt,this._locked=!1,this._inputListeners=[],this._inputManager=t,this._initInputListener(),this._addInputListeners(),this._cameraPosition=new THREE.Vector3,this._targetPosition=new THREE.Vector3,e?this._cameraPosition.copy(e):this._cameraPosition=new THREE.Vector3(0,.5,3);let s=this._domHelper.getClientDimensions();this._width=s.x,this._height=s.y}getCamera(){return this._getCamera()}_addInputListeners(){this._inputListeners.forEach(t=>{this._inputManager.addEventListener(t.key,t.fun,this)})}_removeInputListeners(){this._inputListeners.forEach(t=>{this._inputManager.removeEventListener(t.key,t.fun)}),this._inputListeners=[]}cleanUp(){this._removeInputListeners()}animateCamera(t){let e=this._cameraPosition;if(!e||_t(e,this.getCamera().position))return!1;let s=this.getCamera().position.clone(),i=Math.min(10*t,1);return s.lerp(e,i),this.getCamera().position.copy(s),!0}_areEqual(t,e){return t.yaw.toFixed(5)===e.yaw.toFixed(5)&&t.pitch.toFixed(5)===e.pitch.toFixed(5)&&t.distance.toFixed(5)===e.distance.toFixed(5)&&t.targetX===e.targetX&&t.targetY===e.targetY&&t.targetZ===e.targetZ}_tweenCameraParameter(t,e,s){return new Promise(s=>{if(e.yaw-t.yaw>-Math.PI?e.yaw-t.yaw<Math.PI||(t.yaw+=2*Math.PI):t.yaw-=2*Math.PI,window.TWEEN){if(null!==this._tweenEnd&&this._tweenEnd.blockOtherTweens)return;this._tweenEnd=e,new TWEEN.Tween(t).to(e,400).easing(TWEEN.Easing.Sinusoidal.In).onUpdate(()=>{this._yaw=t.yaw,this._pitch=t.pitch,this._distance=t.distance,this._update(new THREE.Vector3(t.targetX,t.targetY,t.targetZ))}).onComplete(()=>{this._tweenEnd=null,s()}).start()}})}_getCurrentCameraParameters(){let t=this._targetPosition.clone();return{yaw:this._yaw,pitch:this._pitch,distance:this._distance,targetX:t.x,targetY:t.y,targetZ:t.z}}_rotateHorizontal(t){this._yaw-=t,this._yaw<-Math.PI?this._yaw+=2*Math.PI:this._yaw>Math.PI&&(this._yaw-=2*Math.PI)}_rotateVertical(t){this._pitch+=t,this._pitch<-Math.PI?this._pitch+=2*Math.PI:this._pitch>Math.PI&&(this._pitch-=2*Math.PI)}saveState(t){if(t||!this._stateSaved){let t=this._yaw,e=this._pitch,s=this._distance,i=this._targetPosition.clone();if(this._stateSaved={yaw:t,pitch:e,distance:s,targetX:i.x,targetY:i.y,targetZ:i.z,blockOtherTweens:!0},this._getCamera().fov){let t=this._getCamera();this._stateSaved.fov=t.fov,this._stateSaved.near=t.near,this._stateSaved.far=t.far}return this._stateSaved}return null}resetToState(){if(this._stateSaved){let t=this._targetPosition.clone();this._tweenCameraParameter({yaw:this._yaw,pitch:this._pitch,distance:this._distance,targetX:t.x,targetY:t.y,targetZ:t.z},this._stateSaved,!0)}this._stateSaved=null}setToState(t,e){this._tweenCameraParameter(t,e,!0)}hasSavedState(){return null!=this._stateSaved}lock(){this._locked=!0}unlock(){this._locked=!1}getTargetPosition(){return this._targetPosition}}e([n],T.prototype,"_domHelper",void 0);class Mt{constructor(t,e){this.minZoom=!1,this.maxZoom=!1,this.minZoom=t,this.maxZoom=e}}const xt=1,Ct=4,bt=4,Dt=2.725;class m extends T{constructor(t,e,s,i){super(t,s),this._bounds=new THREE.Vector3,this._scale=1,this._state=0,this._zoomSpeed=Math.pow(.95,Ct),this.minDistance=0,this.maxDistance=5,this.minPolarAngle=E(0),this.maxPolarAngle=E(85),this.minAzimuthAngle=Number.NEGATIVE_INFINITY,this.maxAzimuthAngle=Number.POSITIVE_INFINITY,this._currentZoomHash="",i?this._camera=i:this._initCamera(),this._domElement=e,this._targetPosition=new THREE.Vector3(0,0,0)}_getCamera(){return this._camera?this._camera:(this._initCamera(),this._camera)}_initCamera(){this._camera=new THREE.PerspectiveCamera,this._camera.fov=30,this._camera.aspect=this._width/this._height,this._camera.near=.1,this._camera.far=100,this._camera.updateProjectionMatrix(),this._camera.layers.set(3),this._camera.layers.enable(1),this._camera.layers.enable(2),this._camera.layers.enable(5),this._camera.layers.enable(4)}updateCamera(){let{x:t,y:e}=this._domHelper.getClientDimensions();this._camera.aspect=t/e,this._camera.updateProjectionMatrix()}animateCamera(t){if(!super.animateCamera(t))return!1;let e=this._targetPosition;return!!e&&(this.getCamera().lookAt(e),!0)}_initInputListener(){this._inputListeners.push({key:3,fun:t=>{this._state=1}}),this._inputListeners.push({key:6,fun:t=>{1!==this._state||this._locked||this._move(new THREE.Vector2(t.position.x,t.position.y))}}),this._inputListeners.push({key:4,fun:t=>{1===this._state&&this.dispatchEvent(2),this._state=0,this._orbitPosition=null}}),this._inputListeners.push({key:7,fun:t=>this.zoomIn()}),this._inputListeners.push({key:8,fun:t=>this.zoomOut()})}_move(t){this._orbitPosition||(this._orbitPosition=new THREE.Vector2(t.x,t.y),this.dispatchEvent(0));let e=t.clone().sub(this._orbitPosition),s=this._domElement instanceof Document?this._domElement.body:this._domElement;this._rotateHorizontal(2*Math.PI*e.x/s.clientWidth*xt),this._rotateVertical(2*Math.PI*e.y/s.clientHeight*xt),ct(this._orbitPosition,t)||this.dispatchEvent(1),this._orbitPosition.copy(t),this._update()}setBounds(t){let e=new THREE.Vector3(-t.x/2,0,-t.z/2),s=new THREE.Vector3(t.x/2,t.y,t.z/2);this._boundingBox=new THREE.Box3(e,s)}updateToBounds(t,e,s,i,n=!0,a){let o=new THREE.Vector3(-t.x/2,0,-t.z/2),r=new THREE.Vector3(t.x/2,t.y,t.z/2);if(this._boundingBox=new THREE.Box3(o,r),this._targetPosition=a?a.clone():new THREE.Vector3(0,t.y/2,0),this._distance===Rt){let i=this._setDistanceAndRangesBasedOnBounds(t,e,s);this._distance=Math.max(bt,i),this._update()}else n&&(this._setDistanceAndRangesBasedOnBounds(t,e,s),this._tweenCameraParameter(this._getCurrentCameraParameters(),{yaw:this._yaw,pitch:this._pitch,distance:this._distance,targetX:this._targetPosition.x,targetY:this._targetPosition.y,targetZ:this._targetPosition.z},i))}_setDistanceAndRangesBasedOnBounds(t,e,s){this._bounds.copy(t),this.minDistance=Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z);let i=1.1*it(t.x,t.y,t.z,this._camera.fov,e,s);return this._distance<i&&(this._distance=i),this.maxDistance=1.5*i,this.maxDistance=Math.min(this.maxDistance,i+6),this.maxDistance<bt&&(this.maxDistance=bt),this._camera.far=5*this.maxDistance,i}reset(t,e,s,i,n,a,o=!0){if(t){i?this._targetPosition.copy(i):this._targetPosition=new THREE.Vector3(0,t.y/2,0);let r=this._getCurrentCameraParameters();n||(n=-15),a||(a=10),this._pitch=E(a),this._yaw=E(n),this._setDistanceAndRangesBasedOnBounds(t,e,s);let h=this._targetPosition.clone();this._areEqual(r,{yaw:this._yaw,pitch:this._pitch,distance:this._distance,targetX:h.x,targetY:h.y,targetZ:h.z})?this._moveCameraForthAndBack():o?this._tweenCameraParameter(r,{yaw:this._yaw,pitch:this._pitch,distance:this.maxDistance,targetX:h.x,targetY:h.y,targetZ:h.z},!0):this._update(this._targetPosition)}else console.warn("you cant reset without bounds!")}updateAndReset(t,e,s,i,n,a,o,r=!0){let h=new THREE.Vector3(-t.x/2,0,-t.z/2),_=new THREE.Vector3(t.x/2,t.y,t.z/2);if(this._boundingBox=new THREE.Box3(h,_),o&&t.addScalar(o),i?this._targetPosition.copy(i):this._targetPosition=new THREE.Vector3(0,t.y/2,0),this._distance===Rt){let i=this._setDistanceAndRangesBasedOnBounds(t,e,s);this._distance=Math.max(bt,i)}let l=this._getCurrentCameraParameters();n||(n=-15),a||(a=10),this._pitch=E(a),this._yaw=E(n),this._setDistanceAndRangesBasedOnBounds(t,e,s);let c=this._targetPosition.clone();r?this._tweenCameraParameter(l,{yaw:this._yaw,pitch:this._pitch,distance:this.maxDistance,targetX:c.x,targetY:c.y,targetZ:c.z},!0):this._update(this._targetPosition)}_moveCameraForthAndBack(){if(window.TWEEN){let t={value:.6*this._camera.far},e={value:this._distance};new TWEEN.Tween(t).to(e,300).easing(TWEEN.Easing.Sinusoidal.In).onUpdate(()=>{this._distance=t.value,this._update()}).start()}}_restoreFromState(t){this._yaw=t.yaw,this._pitch=t.pitch,this._distance=t.distance,this._targetPosition.copy(new THREE.Vector3(t.targetX,t.targetY,t.targetZ)),this._simulateUpdate()}simulateTo2D(t,e){return new Promise(s=>{let i=Math.max(t.x,t.z),n=it(i,i,i,this._camera.fov,window.innerWidth,window.innerHeight),a=this._getCurrentCameraParameters();this._camera.near=1,this._camera.far=n+50,this._camera.updateProjectionMatrix();let o={yaw:0,pitch:E(90),distance:n,targetX:e.x,targetY:n,targetZ:e.z};if(window.TWEEN){if(null!==this._tweenEnd&&this._tweenEnd.blockOtherTweens)return;this._tweenEnd=o,new TWEEN.Tween(a).to(o,500).easing(TWEEN.Easing.Quadratic.InOut).onUpdate(()=>{this._yaw=a.yaw,this._pitch=a.pitch,this._distance=a.distance,this._targetPosition.copy(new THREE.Vector3(a.targetX,0,a.targetZ)),this._simulateUpdate()}).onComplete(()=>{this._tweenEnd=null,s()}).start()}})}simulateTo3D(t,e){return new Promise(s=>{if(this._restoreFromState(t),window.TWEEN){if(null!==this._tweenEnd&&this._tweenEnd.blockOtherTweens)return;this._tweenEnd=e,new TWEEN.Tween(t).to(e,500).easing(TWEEN.Easing.Linear.None).onUpdate(()=>{this._yaw=t.yaw,this._pitch=t.pitch,this._distance=t.distance,this._targetPosition.copy(new THREE.Vector3(t.targetX,t.targetY,t.targetZ)),this._simulateUpdate()}).onComplete(()=>{this._tweenEnd=null,s()}).start()}})}simulateToFirstPerson(t){return new Promise(e=>{if(window.TWEEN){let s=this.getCamera().position,i={x:s.x,y:s.y,z:s.z,yaw:this._yaw,pitch:this._pitch},n={x:t.x,y:t.y,z:t.z,yaw:0,pitch:0};new TWEEN.Tween(i).to(n,500).easing(TWEEN.Easing.Linear.None).onUpdate(()=>{this._yaw=i.yaw,this._pitch=i.pitch,this._targetPosition.copy(new THREE.Vector3(i.x,i.y,i.z)),this._simulateUpdate()}).onComplete(()=>{this._tweenEnd=null,e()}).start()}})}_update(t){this._yaw=Math.max(this.minAzimuthAngle,Math.min(this.maxAzimuthAngle,this._yaw)),this._pitch=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._pitch)),this._saveYawAndPitch();let e=new THREE.Euler(-this._pitch,this._yaw,0,"ZYX"),s=(new THREE.Quaternion).setFromEuler(e),i=new THREE.Vector3(0,0,-1);i.applyQuaternion(s),this._distance*=this._scale,this._distance=Math.min(this.maxDistance,this._distance),t&&this._targetPosition.copy(t);let n=this._targetPosition.clone().sub(i.multiplyScalar(this._distance)),a=this._getCameraSphere(n);null!=this._boundingBox&&this._boundingBox.intersectsSphere(a)&&this._scale>=1?this._distance+=.1:null==this._boundingBox||this._boundingBox.intersectsSphere(a)?this._zoomChanged(!1,!0):(this._cameraPosition.copy(n),this._distance===this.maxDistance?this._zoomChanged(!0,!1):this._zoomChanged(!1,!1)),this._scale=1}_zoomChanged(t,e){let s=t+""+e;0!==this._currentZoomHash.length&&this._currentZoomHash===s||(this.dispatchEvent(5,new Mt(t,e)),this._currentZoomHash=s)}_simulateUpdate(){let t=new THREE.Euler(-this._pitch,this._yaw,0,"ZYX"),e=(new THREE.Quaternion).setFromEuler(t),s=new THREE.Vector3(0,0,-1);s.applyQuaternion(e),this._cameraPosition.copy(this._targetPosition.clone().sub(s.multiplyScalar(this._distance)))}zoomTo(t,e,s,i,n,a){return this._tweenCameraParameter(this._getCurrentCameraParameters(),{yaw:i,pitch:n,distance:it(t.x,t.y,t.z,this._camera.fov,e,s)*Dt,targetX:a.x,targetY:a.y,targetZ:a.z,blockOtherTweens:!0},!0)}_getCameraSphere(t){return new THREE.Sphere(t,.1)}_saveYawAndPitch(){this._camera.userData.yaw=this._yaw,this._camera.userData.pitch=this._pitch}zoomIn(t){this._scale*=t?Math.pow(.95,t):this._zoomSpeed,this._update(),this.dispatchEvent(3)}zoomOut(t){this._scale/=t?Math.pow(.95,t):this._zoomSpeed,this._update(),this.dispatchEvent(4)}}class h{constructor(t,e){this._scene=t,e&&e.removeFromScene()}}const Lt="_start",Ht=new Map;class v{static start(t){if(!window.performance||!window.performance.getEntriesByName)return"";let e=window.performance.getEntriesByName(t).length++,s="";100>e&&(s="0"),10>e&&(s="0"+s);const i=e>0?t+"_"+s+e:t,n=i+Lt;return window.performance.mark(n),i}static addMeta(t,e){const s=v.getMeta(t);Ht.set(t,Object.assign(s,e))}static getMeta(t){return Ht.get(t)||{}}static end(t){}static getMeasure(t){return[]}static showBenchmarks(t){const e=window.performance.getEntriesByType("measure");e.sort(function(t,e){return t.startTime-e.startTime});const s=[];for(let i=0,n=e.length;n>i;i++){const n=e[i];t&&-1===n.name.indexOf(t)||s.push({Start:parseFloat(n.startTime.toFixed(2)),Name:n.name,Duration:parseFloat(n.duration.toFixed(2))})}console.table(s)}}const St=.8,At={SOFA:"sofa",SHELF:"shelf"};class C{static createDynamicLightSettingSource(t,e){let s={};if(t)s.url=t;else if(e)switch(e){case At.SHELF:s.url=i()+"static/predefined_lightsettings/shelf.json";break;case At.SOFA:s.url=i()+"static/predefined_lightsettings/sofa.json";break;default:s=null}else s=null;return s}parse(t){let e=JSON.parse(t);return e.lights?this.load(e):[]}load(t){let e=[];return t.lights.forEach(t=>{let s;switch(t.type){case"ambient":s=this._parseAmbientLight(t);break;case"rectarea":s=this._parseRectAreaLight(t);break;case"spot":s=this._parseSpotLight(t)}s&&e.push(s)}),e}_parseAmbientLight(t){let e=new THREE.AmbientLight;return this._parseCommon(e,t),e}_parseRectAreaLight(t){let e=new THREE.RectAreaLight;this._parseCommon(e,t);let{intensity:s,castShadow:i,target:n,width:a,height:o}=t;return e.width=a||St,e.height=o||St,e.castShadow=i||!1,e.matrixAutoUpdate=!0,e.intensity=(s||240)/((a||St)*(o||St)),e.lookAt(n?new THREE.Vector3(n.x,n.y,n.z):new THREE.Vector3(0,0,0)),e}_parseSpotLight(t){let e=new THREE.SpotLight;this._parseCommon(e,t);let{angle:s,penumbra:i,target:n,castShadow:a}=t;return e.angle=(s||100)*Math.PI/180,e.penumbra=i||.5,e.lookAt(n?new THREE.Vector3(n.x,n.y,n.z):new THREE.Vector3(0,0,0)),e.shadow.camera.near=.1,e.shadow.camera.far=10,e.shadow.mapSize=new THREE.Vector2(1024,1024),e.castShadow=a||!1,e}_parseCommon(t,e){let{name:s,intensity:i,color:n,position:a,movesWithCamera:o}=e;t.name=s||"",t.intensity=i||1,t.color=new THREE.Color(n||"#ffffff"),t.position.copy(a?new THREE.Vector3(a.x,a.y,a.z):new THREE.Vector3(0,0,0)),t.visible=!0,t.layers.set(1),t.userData.movesWithCamera=o}}let It={},kt={};class P{fetch(t,e){return new Promise((s,n)=>{!function(t,e,s,n){if(-1===t.indexOf("http")&&(t=i()+t),It[t])return s();if(e.id&&kt[e.id])return n('There is already a script with ID "'+e.id+'"');const a=v.start("load_"+e.id.replace(/-/g,"_")),o=document.createElement("script");o.async=!1,o.src=t,o.id=e.id,o.onload=(()=>{It[t]=!0,kt[e.id]=!0,v.end(a),Object.defineProperty(s,"name",{value:"resolve-"+e.id}),s()}),o.onerror=(t=>{n(t)}),document.body.appendChild(o)}(t,e,s,n)})}cleanUp(){for(let t in kt)if(kt.hasOwnProperty(t)){const e=document.getElementById(t);e&&e.parentElement.removeChild(e)}It={},kt={}}}const Nt={JPG:".jpg",JPEG:".jpeg",PNG:".png",GIF:".gif"};class Vt{_base64toBlob(t,e){e=e||"";const s=atob(t),i=s.length,n=Math.ceil(i/1024),a=new Array(n);for(let t=0;n>t;++t){let e=1024*t,n=Math.min(e+1024,i);const o=new Array(n-e);for(let t=e,i=0;n>t;++i,++t)o[i]=s[t].charCodeAt(0);a[t]=new Uint8Array(o)}return new Blob(a,{type:e})}_createFormData(t,e,s,i){const n=new FormData;-1!==t.indexOf(",")&&(t=t.substr(t.indexOf(",")+1));const a=-1===Object.keys(Nt).map(t=>Nt[t]).indexOf(s)?"application":"image",o=this._base64toBlob(t,a+"/"+s.substr(1));return n.append(i,o,e+s),n}create(t,e,s,i){return this._createFormData(t,e,s,i)}}class x{info(...t){console}log(...t){console}warn(...t){console.warn.apply(console,t)}error(...t){console.warn.apply(console,t)}}const zt=new Map,Wt=new Map,Bt=new Map,Ot=new Map,Ut=new Map;let jt=0;class S{constructor(){this._bootCallbacks=[],this._isStarted=!1,this._isStarting=!1}start(t){return this._eventHandler.dispatch(79),this._startWorker().then(()=>this._handleCatalog(t)).then(()=>{const{typeChangeTag:t,floorMaterialsTag:e}=window.__RML__ENV__.initData;Promise.all([this._syncFloorTag(e),this._syncTypeChangeTag(t)]).then(()=>{Ot.set(t,!0),this._eventHandler.dispatch(80)})})}syncCatalog(t){return this._startWorker().then(()=>this._handleCatalog(t))}syncFloorTag(t){return this._startWorker().then(()=>this._syncFloorTag(t))}syncTypeChangeTag(t){return this._startWorker().then(()=>this._syncTypeChangeTag(t))}_syncFloorTag(t){const e=[];return t&&!Bt.get(t)?(e.push(this._handleTags([t])),this._rapiAccess.getTag(t).then(t=>{e.push(this._handleMaterialsAndTextures(t))}),this._singlePromiseFactory.create(1,t,s=>{Promise.all(e).then(()=>{Bt.set(t,!0),s()},t=>this._softReject(s,'_syncFloorTag error: "'+t+'"'))})):Promise.resolve()}_syncTypeChangeTag(t){const e=[];return t&&!Ot.get(t)?(e.push(this._handleTags([t])),this._rapiAccess.getTag(t).then(t=>{this._rapiAccess.getItems(t.items).then(t=>{t.forEach(t=>{this.getIsCatalogSynced(t.catalog)&&e.push(this._handleCatalog(t.catalog))})})}),this._singlePromiseFactory.create(2,t,s=>{Promise.all(e).then(()=>{Bt.set(t,!0),s()},t=>this._softReject(s,'_syncTypeChangeTag error: "'+t+'"'))})):Promise.resolve()}getIsCatalogSynced(t){return!!Wt.get(t)}_startWorker(){return new Promise((t,e)=>{if(this._isStarted)return t();this._bootCallbacks.push({resolve:t,reject:e}),this._isStarting||(this._worker=new Worker(i()+"static/web-workers/asset-loader.js"),this._worker.addEventListener("message",this._receiveFromWorker.bind(this),!1),this._isStarting=!0,this._sendToWorker(1))})}_sendToWorker(t,e=null,s,i){const n=this._nextConversationId(),a=()=>!1;!s&&i&&(s=a),s&&!i&&(i=a),s&&i&&Ut.set(n,{resolve:s,reject:i}),this._worker.postMessage(JSON.stringify(["rml."+t,n,e]))}_nextConversationId(){return jt++}_receiveFromWorker(t){if(!t||!t.data)return;const[e,s,i]=JSON.parse(t.data);if(!e||0!==e.indexOf("rml"))return;const[n,a]=e.split(".");switch(parseInt(a,10)){case 4:this._isStarted=!0,this._bootCallbacks.forEach(({resolve:t})=>t());break;case 3:this._triggerCallback(s,i)}}_triggerCallback(t,e=[]){const s=Ut.get(t);s.resolve.apply(s,e),Ut.delete(t)}_handleCatalog(t){return this._singlePromiseFactory.create(0,t,e=>this.getIsCatalogSynced(t)?e():this._rapiAccess.getCatalog(t).then(t=>Promise.all([this._handleContentWithAssets(this._rapiAccess.getComponentsOf(t),["perspectiveImage"]),this._handleItemsAndAdditionalContents(t),this._handleMaterialsAndTextures(t),this._handleExternalMeshes(t),this._handleTags(t.tags)])).then(()=>{Wt.set(t,!0),e()},t=>this._softReject(e,'Catalog sync error: "'+t+'"')))}_handleTags(t){return this._handleContentWithAssets(this._rapiAccess.getTags(t),["pngIcon","svgIcon"])}_handleExternalMeshes(t){return new Promise(e=>{this._rapiAccess.getMeshesOfCatalog(t.id).then(t=>{const s=[];t.forEach(t=>{s.push(this._handleContentWithAssets(Promise.all([this._rapiAccess.getMesh(t.id)]),["url"]))}),Promise.all(s).then(e,t=>this._softReject(e,'Sync crt files error: "'+t+'"'))},t=>this._softReject(e,'getMeshesOfCatalog error: "'+t+'"'))})}_handleItemsAndAdditionalContents(t){return new Promise((e,s)=>{this._rapiAccess.getItemsOf(t).then(t=>{const s=[];s.push(this._handleContentWithAssets(Promise.resolve(t),["perspectiveImage"])),this._rapiAccess.getAdditionalContentsOfItems(t).then(t=>{const e=t.filter(t=>-1!==[5,6,4].indexOf(t.type));s.push(this._handleContentWithAssets(Promise.resolve(e),["content"]))},t=>this._softReject(e,'getAdditionalContentsOfItems error: "'+t+'"')),Promise.all(s).then(e,t=>this._softReject(e,'AdditionalContent image sync error:"'+t+'"'))})})}_handleMaterialsAndTextures(t){return new Promise((e,s)=>{this._rapiAccess.getMaterialsOf(t).then(t=>{const s=[];s.push(this._handleContentWithAssets(Promise.resolve(t),["thumbnail"])),t.forEach(t=>{s.push(this._handleContentWithAssets(this._rapiAccess.getTexturesOf(t),["image"]))}),Promise.all(s).then(e,t=>this._softReject(e,'getTexturesOf error: "'+t+'"'))},t=>this._softReject(e,'getMaterialsOf error: "'+t+'"'))})}_handleContentWithAssets(t,e){return new Promise(s=>t.then(t=>this._fetchAssets(t,e).then(s,t=>this._softReject(s,'_handleContentWithAssets error: "'+t+'"')),t=>this._softReject(s,'_handleContentWithAssets promise error: "'+t+'"')))}_fetchAssets(t,e){const s=[];t||(t=[]);for(let i=0,n=t.length;n>i;i++){const n=t[i];e.forEach(t=>{const e=n[t];e&&s.push(this._preCacheAsset(e))})}return Promise.all(s)}_preCacheAsset(t){return new Promise(e=>{if(zt.get(t))return e();this._assetUrlToBase64(t).then(s=>{zt.set(t,s),e()},t=>this._softReject(e,'_preCacheAsset error: "'+t+'"'))})}_assetUrlToBase64(t){return new Promise(e=>{this._sendToWorker(5,t,e,t=>this._softReject(e,'_assetUrlToBase64 error: "'+t+'"'))})}_softReject(t,e){this._errorHandler.softReject(t,e,2)}requestAsset(t,e=!1){if(navigator.onLine)return t;return zt.get(t)||(e?t:null)}}e([n],S.prototype,"_rapiAccess",void 0),e([n],S.prototype,"_eventHandler",void 0),e([n],S.prototype,"_singlePromiseFactory",void 0),e([n],S.prototype,"_errorHandler",void 0);class Ft{constructor(){this._lookups=new Map,this._singletons=new Map}addDependencyInjectionAssignments(t){t.forEach(t=>{this._lookups.set(t.className,t)})}lookup(t){if(!this._lookups.has(t))return null;let e=this._lookups.get(t);if(!e.singleton)return new e.classDefinition;if(this._singletons.has(t))return this._singletons.get(t);let s=new e.classDefinition;return this._singletons.set(t,s),s}}class R{constructor(t,e,s){this.className=t,this.classDefinition=e,this.singleton=void 0===s||s}}class Yt{constructor(t,e,s){this.position=t,this.positionRelative=e,this.type=s}}const Gt=5*window.devicePixelRatio,Xt=2*window.devicePixelRatio;class H extends r{constructor(){super(),this._debug=!1,this._delta=-1,this._state=0,this._pinchDistance=-1,this._lastMouseWheelEvent=null,this._lastTouchEvent=null,this._position={x:0,y:0},this._positionRelative={x:0,y:0},this._downPosition={x:0,y:0},this._downPositionRelative={x:0,y:0}}enableDragIn(t){this._state=1,this._dragEnabled=!0,t&&(this._dragMV=this._dragM.bind(this),this._dragEV=this._dragE.bind(this),this._dragTarget=t.currentTarget||t.target,this._delta=-1,this._dragMVName="drag",this._dragEVName="dragend",window.TouchEvent&&t instanceof TouchEvent?(this._dragMVName="touchmove",this._dragEVName="touchend"):t.dataTransfer&&t.dataTransfer.setData&&t.dataTransfer.setData("text/plain"," "),this._firefoxDragPosition={x:0,y:0},document.ondragover=(t=>{t=t||window.event,this._firefoxDragPosition.x=t.pageX,this._firefoxDragPosition.y=t.pageY}),this._dragTarget.addEventListener(this._dragMVName,this._dragMV,!1),this._dragTarget.addEventListener(this._dragEVName,this._dragEV,!1))}_dragM(t){let e=t,s=null,i=null;window.TouchEvent&&t instanceof TouchEvent?(s=this._getTouchPosition(e),i=this._getTouchPositionRelative(e)):(s=this._getMousePosition(e),i=this._getMousePositionRelative(e)),s.x>0&&s.y>0&&this._move(s,i)}_dragE(t){let e=t;document.ondragover=null,this._firefoxDragPosition=null,this._dragTarget.removeEventListener(this._dragMVName,this._dragMV),this._dragTarget.removeEventListener(this._dragEVName,this._dragEV),window.TouchEvent&&t instanceof TouchEvent?this._onUp(this._getTouchPosition(e),this._getTouchPositionRelative(e)):this._onUp(this._getMousePosition(e),this._getMousePositionRelative(e))}addEvents(t){t.addEventListener("mousemove",this._onDocumentMouseMove.bind(this),!1),t.addEventListener("mousedown",this._onDocumentMouseDown.bind(this),!1),t.addEventListener("mouseup",this._onDocumentMouseCancel.bind(this),!1),t.addEventListener("mouseleave",this._onDocumentMouseLeave.bind(this),!1),t.addEventListener("mouseenter",this._onDocumentMouseEnter.bind(this),!1),t.addEventListener("touchmove",this._onDocumentTouchMove.bind(this),!1),t.addEventListener("touchstart",this._onDocumentTouchStart.bind(this),!1),t.addEventListener("touchend",this._onDocumentTouchEnd.bind(this),!1),t.addEventListener("wheel",this._onMouseWheel.bind(this),!1),t.addEventListener("contextmenu",this._onContextMenu.bind(this),!1)}_onDocumentMouseMove(t){this._debug,t.preventDefault(),this._move(this._getMousePosition(t),this._getMousePositionRelative(t),1)}_onDocumentTouchMove(t){this._debug,t.preventDefault(),this._dragTarget||(1===t.touches.length&&this._move(this._getTouchPosition(t),this._getTouchPositionRelative(t),2),2===t.touches.length&&(this._state=3,this._dolly(t)))}_dolly(t){if(this._lastTouchEvent&&40>t.timeStamp-this._lastTouchEvent.timeStamp)return;let e=t.touches[0].pageX-t.touches[1].pageX,s=t.touches[0].pageY-t.touches[1].pageY,i=Math.abs(e)+Math.abs(s);i>this._pinchDistance+Xt&&this.dispatchEvent(7,new Yt),i<this._pinchDistance-Xt&&this.dispatchEvent(8,new Yt),this._pinchDistance=i,this._lastTouchEvent=t}_move(t,e,s){void 0===s&&(s=0),void 0===this._dragEnabled&&(this._dragEnabled=!1),(1===this._state&&2!==s||1===this._state&&this._dragEnabled&&2===s)&&(this._delta=this._getDelta(),this._delta>Gt&&(this._state=2,this._longClickTimer&&clearTimeout(this._longClickTimer),this.dispatchEvent(0,new Yt(t,e)))),2===this._state&&this.dispatchEvent(1,new Yt(t,e)),this._longClickTimer&&clearTimeout(this._longClickTimer),this.dispatchEvent(6,new Yt(t,e,s))}_onDocumentMouseDown(t){this._debug,t.preventDefault();let{x:e,y:s}=this._getMousePosition(t);this._downPosition={x:e,y:s},this._downPositionRelative=this._getMousePositionRelative(t),this.dispatchEvent(3,new Yt({x:e,y:s},this._downPositionRelative,1)),this._state=1}_onDocumentTouchStart(t){if(this._debug,t.preventDefault(),1===t.touches.length){let{x:e,y:s}=this._getTouchPosition(t);this._downPosition={x:e,y:s},this._downPositionRelative=this._getTouchPositionRelative(t),this.dispatchEvent(3,new Yt({x:e,y:s},this._downPositionRelative,2)),this._state=1,this._longClickTimer=window.setTimeout(this._longClick.bind(this),350)}else 2===t.touches.length&&(1!==this._state&&2!==this._state||this._onUp(this._getTouchPosition(t),this._getTouchPositionRelative(t)),this._state=3)}_longClick(){this._state=2,this._longClickTimer&&clearTimeout(this._longClickTimer),this.dispatchEvent(0,new Yt(this._downPosition,this._downPositionRelative)),this.dispatchEvent(1,new Yt(this._downPosition,this._downPositionRelative))}_onDocumentMouseLeave(t){this._delta=-1,this._onDocumentMouseCancel(t)}_onDocumentMouseEnter(t){this._debug,t.preventDefault()}_onDocumentMouseCancel(t){this._debug,t.preventDefault(),this._onUp(this._getMousePosition(t),this._getMousePositionRelative(t))}_onDocumentTouchEnd(t){this._debug,t.preventDefault(),this._onUp(this._getTouchPosition(t),this._getTouchPositionRelative(t))}_onUp(t,e){this.dispatchEvent(4,new Yt(t)),this._getDelta()>Gt||this.dispatchEvent(5,new Yt(t,e)),2===this._state&&this.dispatchEvent(2,new Yt(t,e)),3===this._state&&(this._pinchDistance=-1),this._lastTouchEvent=null,this._state=0,this._dragTarget=null,this._longClickTimer&&clearTimeout(this._longClickTimer)}_onMouseWheel(t){this._debug,t.preventDefault(),t.stopPropagation(),this._lastMouseWheelEvent&&40>t.timeStamp-this._lastMouseWheelEvent.timeStamp||(0>t.deltaY?this.dispatchEvent(7,new Yt):this.dispatchEvent(8,new Yt),this._lastMouseWheelEvent=t)}_onContextMenu(t){t.preventDefault()}_getTouchPosition(t){if(t.changedTouches.length){let{clientX:e,clientY:s}=t.changedTouches[0];this._position.x=e,this._position.y=s}return this._position}_getTouchPositionRelative(t){if(t.changedTouches.length){let e=this._domHelper.element.getBoundingClientRect(),{clientX:s,clientY:i}=t.changedTouches[0];this._positionRelative.x=(s-e.left)/this._domHelper.element.clientWidth*2-1,this._positionRelative.y=-(i-e.top)/this._domHelper.element.clientHeight*2+1}return this._positionRelative}_getMousePosition(t){return this._position.x=t.clientX,this._position.y=t.clientY,this._position}_getMousePositionRelative(t){if(0!==t.clientX&&0!==t.clientY){let e=this._domHelper.element.getBoundingClientRect();this._positionRelative.x=(t.clientX-e.left)/this._domHelper.element.clientWidth*2-1,this._positionRelative.y=-(t.clientY-e.top)/this._domHelper.element.clientHeight*2+1}else if(this._firefoxDragPosition&&0!==this._firefoxDragPosition.x&&0!==this._firefoxDragPosition.y){let t=this._domHelper.element.getBoundingClientRect();this._positionRelative.x=(this._firefoxDragPosition.x-t.left)/this._domHelper.element.clientWidth*2-1,this._positionRelative.y=-(this._firefoxDragPosition.y-t.top)/this._domHelper.element.clientHeight*2+1}return this._positionRelative}_getDelta(){return Math.abs(this._downPosition.y-this._position.y)+Math.abs(this._downPosition.x-this._position.x)}setDragEnabled(t){this._dragEnabled=t}}e([n],H.prototype,"_domHelper",void 0);const Zt=40;class qt{constructor(){this._queue=[],this._pendingRequests=0}_nextSlot(){if(this._pendingRequests-=1,!this._queue.length)return;const{request:t,resolve:e,reject:s}=this._queue.shift();this._fetch(t).then(e,s)}_fetch(t){return this._pendingRequests+=1,new Promise((e,s)=>{self.fetch(t).then(function(){this._nextSlot(),e(...arguments)}.bind(this),t=>{this._nextSlot(),s(t)})})}fetch(t){return this._pendingRequests<Zt?this._fetch(t):new Promise((e,s)=>this._queue.push({request:t,resolve:e,reject:s}))}}class Jt extends x{throw(t){this.error("[Kernel Exception]: "+t),this._eventHandler.dispatch(27)}}e([n],Jt.prototype,"_eventHandler",void 0);const Xe=[new R("error-handler",class{constructor(){this._listeners={}}_subscribe(t,e){this._listeners[t]||(this._listeners[t]=[]),this._listeners[t].push(e)}subscribe(t,e){this._subscribe(t,e)}dispatch(t,e){if(!this._listeners[t])return;const s=this._listeners[t];let i=s.length;for(let t=0;i>t;t++){const i=s[t];i.apply(i,e)}}unsubscribe(t,e){if(!this._listeners[t])return;const s=this._listeners[t];let i=s.length;for(let t=0;i>t;t++)if(s[t]===e)return s.splice(t,1),i--,void t--}softReject(t,e,s){return this.dispatch(s,[e]),t()}}),new R("form-data-util",Vt),new R("environment-loader",class{getEnvironmentMap(){if(!this._environmentMap){let t=new THREE.CubeTextureLoader;t.setPath(i()),this._environmentMap=t.load(["static/textures/blurred/px.png","static/textures/blurred/nx.png","static/textures/blurred/py.png","static/textures/blurred/ny.png","static/textures/blurred/pz.png","static/textures/blurred/nz.png"]),this._environmentMap.wrapS=THREE.RepeatWrapping,this._environmentMap.wrapT=THREE.RepeatWrapping,this._environmentMap.generateMipmaps=!0}return this._environmentMap}}),new R("form-data-util",Vt),new R("single-promise-factory",class{constructor(){this._promises=new Map}create(t,e,s){return new Promise((i,n)=>{let a=this._promises.get(t),o=!0;if(!a){const e=new Map;this._promises.set(t,e),a=this._promises.get(t),o=!1}a.get(e)||(a.set(e,[]),o=!1);const r=a.get(e);r.push({resolve:i,reject:n}),a.set(e,r),o||new Promise(s).then(s=>{a.get(e).forEach(({resolve:t})=>t(s)),this._promises.delete(t)},s=>{a.get(e).forEach(({reject:t})=>t(s)),this._promises.delete(t)})})}}),new R("dynamic-light-setting-loader",C),new R("network-layer",qt),new R("local-storage",class{get _localStorage(){let t=null;try{t=window.localStorage}catch(t){console.error(t)}return t}getItem(t){if(!this._localStorage)return null;const e=this._localStorage.getItem(t);try{return JSON.parse(e)}catch(t){return e}}setItem(t,e){this._localStorage&&this._localStorage.setItem(t,JSON.stringify(e))}}),new R("network-layer",qt),new R("kernel-io",Jt),new R("data-syncer",S),new R("memory-manager",class{constructor(){this._configurationStringSet=new Set,this._singleLoadCounter=0}loadingConfigurationString(){this._singleLoadCounter+=1}loadingConfiguration(t){this._configurationStringSet.add(t),this._singleLoadCounter+=1}shouldHardReset(){return this._configurationStringSet.size>=15||this._singleLoadCounter>=30}executedHardReset(){this._configurationStringSet.clear(),this._singleLoadCounter=0}})];class L{static setup(t){L.addToContainer(t)}static lookup(t){return window.__RML__DI__?window.__RML__DI__.lookup(t):null}static addToContainer(t){window.__RML__DI__||(window.__RML__DI__=new Ft,window.__RML__DI__.addDependencyInjectionAssignments(Xe)),window.__RML__DI__.addDependencyInjectionAssignments(t)}}export{i as a,s as b,o as c,r as d,a as e,h as f,l as g,d as h,c as i,_ as j,p as k,m as l,u as m,g as n,b as o,w as p,E as q,v as r,C as s,f as t,H as u,y as v,T as w,P as x,x as y,S as z,R as A,I as B,L as C,ft as D,ot as E,ht as F,rt as G,Nt as H,Tt as I,pt as J,Gt as K,ct as L,_t as M,lt as N,at as O,wt as P,gt as Q,mt as R,ut as S,dt as T,Et as U,Pt as V};
//# sourceMappingURL=chunk-e1cce45d.js.map
