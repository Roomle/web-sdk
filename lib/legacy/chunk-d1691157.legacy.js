System.register(["./chunk-901f3da1.legacy.js","./chunk-f6df32c2.legacy.js","./chunk-1292a462.legacy.js"],function(e,t){var r,a,s,i,n,o,h,c,l,g,p,d,u,m,_;return{setters:[function(e){r=e.h,a=e.e,s=e.i,i=e.j,n=e.k,o=e.l},function(e){h=e.I,c=e.b,l=e.J,g=e.K,p=e.L,d=e.M,u=e.N},function(e){m=e.a,_=e.b}],execute:function(){e("g",function(e){return!(!e||"string"!=typeof e||e.split(":").length>2)});const f=e("a",e=>{if(!e||"string"!=typeof e)return null;const t=e.split(":");return t.length<2?null:t[0]});e("b",({articleNr:e,componentId:t})=>e&&""!==e?t.split(":")[0]+":"+e:null);var y={isProduction:!0,isUnitTesting:!1,environment:"production",detailEnvironment:"development",features:{},APP:{RAPI:{server:"/api/v2",localReverseProxy:"https://www.roomle.com/api/v2",liveServer:"https://www.roomle.com/api/v2",testServer:"https://www.test.roomle.com/api/v2",headers:{apiKey:"roomle_portal_v2",currentTenant:9,locale:"en",language:"en",device:1,token:"anonymous",platform:"web"},itemHeaders:{assetRevision:"glb",assetFileFormat:"glb"}},WASM:{CONFIGURATOR:{URL:"static/kernel-artifacts/wasm/ConfiguratorKernel.wasm",CACHE_COMPILATION:!0,HASH:"58b3c2a8dadb27752e861fbc8736d706",LOADER:"static/kernel-artifacts/wasm/ConfiguratorKernel.js"},PLANNER:{URL:"static/kernel-artifacts/wasm/RoomleCore.wasm",CACHE_COMPILATION:!0,HASH:"e9e55e51da86e4c2d0cefcbf68417e0f",LOADER:"static/kernel-artifacts/wasm/RoomleCore.js"}},ASM:{CONFIGURATOR:{MEM_URL:"static/kernel-artifacts/ConfiguratorKernelJs.mem",LOADER:"static/kernel-artifacts/ConfiguratorKernelJs.js"},PLANNER:{MEM_URL:"static/kernel-artifacts/RoomleCoreJs.mem",LOADER:"static/kernel-artifacts/RoomleCoreJs.js"}},SHORTENER_URL:"http://rml.co/"},environments:{PRODUCTION:"production",DEVELOPMENT:"development",TEST:"test",TEST_SERVER:"test_server",ALPHA:"alpha"}};void 0!==t&&t.exports||(window.IS_DEBUG=!0),function(e=!1){if(e){let e=JSON.parse(JSON.stringify(y));const t=Object.assign({},e.APP,{SHORTENER_URL:"http://localhost:4747/?isItem=false&id="}),r=Object.assign({},e.features);Object.assign({},e,{isProduction:!1,APP:t,features:r})}}();const v=y;e("c",v);const{APP:w}=v,{RAPI:I}=w,E=I.headers,M=I.itemHeaders,C=E.token,P="live",T=1500,R=e("d","crt"),H=50,S="0",b={GET:"GET",POST:"POST"},O=r(),A=6e4;let L=new Map,x=new Map,D=new Map,k=new Map,B=new Map,U=new Map,j=new Map,N=new Map;const G="hsc_configurations_offline_queue_v1";let F=new Map;const J="__rapi_path__";class V{constructor(){window.addEventListener("online",this._flushOfflineQueue.bind(this))}overrideTenant(e){e&&(this._overrideTenant=e)}setConfiguratorId(e){e&&(this._configuratorId=e)}overrideCountry(e){e&&(this._overrideCountry=e)}overrideRapi(e){e&&(this._overrideRapi=e)}setCustomApiUrl(e){this._customApiUrl=e}getPreloadForItem(e){return this._getPreload(e,!0)}getPreloadForConfiguration(e){return this._getPreload(e,!1)}_getPreload(e,t){return new Promise((r,a)=>{if(!navigator.onLine)return r();if(this._dataSyncer.getIsCatalogSynced(f(e)))return r();if(j.get(e))return r();const s=t?"?itemId=":"?configurationId=";this._get("/preloads/components/"+s+e,"preloads/components").then(t=>{if(j.get(e))return r();t.forEach(e=>{this._prepareData(e,"components")}),j.set(e,!0),r()},a)})}changeUseOfHDGeometry(){const e=k.get("components");j.clear(),U.clear(),e&&k.delete("components")}getHSCPackage(e){return new Promise((t,r)=>{if(U.get(e))return t();this._get("/catalogs/"+e+"/package","package").then(r=>{if(U.get(e))return t(r);r.components.forEach(e=>{this._prepareData(e,"components")}),r.materials.forEach(e=>{this._prepareData(e,"materials"),this._prepareGroups(e)}),r.textures.forEach(e=>{this._prepareData(e,"textures")}),U.set(e,!0),t(r)},r)})}getComponent(e){return this._getById(e,"components")}getConfiguration(e){return this._getById(e,"configurations")}getConfigurations(e){return this._getByIds(e,"configurations")}getItem(e){return this._getById(e,"items",{additionalHeaders:M})}getComponents(e){return this._getByIds(e,"components")}getItems(e){return this._getByIds(e,"items",{additionalHeaders:M})}getTag(e){return this._getById(e,"tags")}getTags(e){return this._getByIds(e,"tags")}getTexture(e){return this._getById(e,"textures")}getCatalog(e){return this._getById(e,"catalogs")}getMesh(e,t=R,r=H){return this._getById(e,"meshes",{pathSuffix:"/data?format="+t+"&targetQuality="+r.toString()})}getMeshesOfCatalog(e){return new Promise((t,r)=>{const a=B.get(e);a?t(a):this._get("/meshes?catalog="+e,"catalogMeshes").then(r=>{B.set(e,r),t(r)},r)})}getTexturesOf(e){return this._getRelationData(e,{rapiPath:"textures"})}getItemsOf(e){return this._getRelationData(e,{rapiPath:"items"})}getMaterialsOf(e){return this._getRelationData(e,{rapiPath:"materials"},{embed:["textures"]})}getComponentsOf(e){return this._getRelationData(e,{rapiPath:"components"})}getAdditionalContentsOfItems(e){const t=[],r=[];return e.forEach(e=>{const a=x.get(e.id.toString());a?r.push(...a):t.push(e.id.toString())}),new Promise((e,a)=>{0!==t.length?this._getByIdsPackets(t,"itemAdditionalContents",{filterKey:"itemIds"}).then(t=>{t.forEach(e=>{let t=x.get(e.itemId);t||(t=[]);for(let r=0,a=t.length;r<a;r++)if(t[r].id===e.id)return;t.push(e),x.set(e.itemId,t)}),e([...t,...r])},a):e(r)})}getMaterial(e){return this._getById(e,"materials",{embed:["textures"]})}peekMaterial(e){return this._peekData(e,"materials")}peekComponent(e){return this._peekData(e,"components")}getMaterials(e){return this._getByIds(e,"materials",{embed:["textures"]})}getPlan(e){return this._getById(e,"plans")}static clearCaches(){L=new Map,D=new Map,k=new Map,U=new Map,j=new Map,N=new Map,x=new Map}cleanUp(){V.clearCaches()}getMaterialsByGroup(e){const t=e.slice(),r=[];let a=t.length;for(let e=0;e<a;e++){const s=L.get(t[e]);if(s){const i=s.length;for(let e=0;e<i;e++){const t=this._getCache("materials").get(s[e]);r.push(t)}t.splice(e,1),a--,e--}}return new Promise((e,a)=>{0!==t.length&&navigator.onLine?this._getByIdsPackets(t,"materials",{filterKey:"groups",embed:["textures"]}).then(t=>{e(this.combineMaterialsToGroups([...t,...r]))},a):e(this.combineMaterialsToGroups(r))})}_flushOfflineQueue(){return new Promise((e,t)=>{const r=this._localStorage.getItem(G),a=[];for(let e in r)if(r.hasOwnProperty(e)){const t=r[e];a.push(new Promise((e,r)=>{this.saveConfiguration(t.data).then(a=>{const s=[];t.perspectiveImage&&!a.perspectiveImage&&s.push(this.savePerspectiveImage(a,t.perspectiveImage)),t.topImage&&!a.topImage&&s.push(this.savePerspectiveImage(a,t.topImage)),Promise.all(s).then(e,r)},r)}))}Promise.all(a).then(()=>{this._localStorage.setItem(G,{}),e()},t)})}_setQueuedConfiguration(e,t={}){const r=e.configurationHash,{perspectiveImage:a,topImage:s}=t;let i=this._localStorage.getItem(G)||{},n=i[r]||{};n.data=e,n.perspectiveImage=a,n.topImage=s,i[r]=n,this._localStorage.setItem(G,i)}saveConfiguration(e){return navigator.onLine?this._save("/configurations",{configuration:e},"configurations",{accept:"application/json",contentType:"application/json; charset=UTF-8"}):(e.perspectiveImage=null,e.topImage=null,this._setQueuedConfiguration(e),this._markConfigurationAsLocally(e),Promise.resolve(e))}saveTopImage(e,t){return this._saveConfigurationImage(e,t,"topImage")}savePerspectiveImage(e,t){return this._saveConfigurationImage(e,t,"perspectiveImage")}getShortUrl(e,t){return new Promise((r,a)=>this._fetchJson("/shortIds","shortIds",{method:b.POST,resolve:r,reject:a,data:JSON.stringify({shortId:{type:t,referencedId:e}}),accept:"application/json",contentType:"application/json; charset=UTF-8"}))}_peekData(e,t){const r=k.get(t);return r&&r.get(e)||null}_saveConfigurationImage(e,t,r){if(!navigator.onLine){const a={};return a[r]=t,this._setQueuedConfiguration(e,a),this._markConfigurationAsLocally(e),e[r]=t.image,Promise.resolve(e)}const a=this._formDataUtil.create(t.image,e.configurationHash,h.PNG,r);return this._save("/configurations/"+e.id+"/"+r,a,"configurations",{accept:"application/json"})}_markConfigurationAsLocally(e){e.isLocally=!0,e.id=e.configurationHash}_save(e,t,r,a={}){const s=t instanceof FormData?t:JSON.stringify(t);return new Promise((t,i)=>{const n={method:b.POST,data:s,resolve:t,reject:i};a.contentType&&(n.contentType=a.contentType),a.accept&&(n.accept=a.accept),this._fetchJson(e,r,n)})}combineMaterialsToGroups(e){return new Promise((t,r)=>{const a=new Map,s={id:null,label:null,materials:[]},i=[];for(let t=0,r=e.length;t<r;t++){const r=e[t],n=r.tags&&r.tags.length?r.tags:r.group?[O+r.group]:[null];r.tags&&r.tags.length&&r.tags.forEach(e=>-1===i.indexOf(e)?i.push(e):null),n.forEach(e=>{const t=r.id;let i=e?L.get(e):[];i||(L.set(e,[]),i=L.get(e)),-1===i.indexOf(t.toString())&&i.push(t.toString());let n=e?a.get(e):s;n||(a.set(e,{id:e,label:r.groupLabel,materials:[]}),n=a.get(e)),n.materials.push(r)})}const n=s.materials.length?[s]:[];this.getTags(i).then(e=>{const r=e.reduce((e,t)=>(e[t.id]=t,e),{});return a.forEach((e,t)=>{n.push({id:t,label:r[t]?r[t].label:e.label,materials:e.materials})}),t(n)},r)})}_getByIds(e,t,r={}){const a=this._getCache(t),s=this._getErrorCache(t),i=[],n=e.slice();let o=n.length;if(a&&a.size){const e=(new Date).getTime();for(let t=0;t<o;t++){const r=n[t],h=a.get(r),c=s.get(r);let l=!1;null!=h?(i.push(h),l=!0):l=void 0!==c&&(e-c.timestamp<A||!1===navigator.onLine),l&&(n.splice(t,1),o--,t--)}}return new Promise((e,a)=>{0!==n.length&&navigator.onLine?this._getByIdsPackets(n,t,r).then(t=>{e([...t,...i])},a):e(i)})}_getByIdsPackets(e,t,r={}){const a=r.filterKey||"ids";let s,i="/"+t+"/",n="?",o=[];const h=e.length;if(!h)return new Promise(e=>e([]));let c=!0,l=[];for(s=0;s<h;s++){c=!1;const r=e[s],h=n+a+"[]="+r,g=h.length+i.length;l.push(r),n="&",g<=T?i+=h:(g>T&&(l.pop(),s--),o.push({url:i,ids:l}),c=!0,i="/"+t+"/",n="?",l=[])}c||o.push({url:i,ids:l});const g=[];return o.forEach(e=>g.push(this._getByIdsSingle(e.ids,e.url,t,r))),new Promise((e,t)=>{Promise.all(g).then(t=>{const r=[];t.length&&t.forEach(e=>r.push(...e)),e(r)},t)})}_getByIdsSingle(e,t,r,a={}){return new Promise((s,i)=>{this._get(t,r,a).then(t=>{for(let r=0,s=t.length;r<s;r++){const s=a&&a.cacheKey?t[r][a.cacheKey]:t[r].id,i=e.indexOf(s.toString());-1!==i&&e.splice(i,1)}const i=e.length;if(i){const t=this._getCache(r),a=this._getErrorCache(r),s=(new Date).getTime();for(let r=0;r<i;r++)a.set(e[r],{code:0,timestamp:s}),t.delete(e[r]);this._errorHandler.dispatch(2,[r,e.map(e=>'"'+e+'"').join(",")])}s(t)},i)})}_getById(e,t,r={}){if(!e||""===e||"string"!=typeof e)return console.error("no id passed to _getById"),Promise.reject(new Error("no id passed to _getById"));const a=this._getCache(t).get(e);if(a)return new Promise(e=>e(a));if(!navigator.onLine)return Promise.reject("Nothing cached but tried to fetch in offline mode");const s=Object.assign({},r,{id:e}),i=r.pathSuffix||"";return this._get("/"+t+"/"+e+i,t,s)}_get(e,t,r={}){const a=c.useHDGeometry?"includeGeometryHD=true":"";let s=-1===e.indexOf("?")?"?":"&";return""!==a&&(e+=s+a),r.embed&&Array.isArray(r.embed)&&r.embed.forEach(t=>{e+=s+"embed"+(t[0].toUpperCase()+t.substr(1))+"=true",s="&"}),new Promise((a,s)=>{const i=N.get(e);Array.isArray(i)&&i.length>0?i.push({resolve:a,reject:s}):(N.set(e,[{resolve:a,reject:s}]),this._fetchJson(e,t,r))})}_fetchJson(e,t,r={}){const s={method:r.method?r.method:b.GET,headers:this._createHeaders(r),mode:"cors",cache:"default"};r.data&&(s.body=r.data);let i=I.server;const n=this._overrideRapi;n&&(i=n===P?I.liveServer:I.testServer),(this._customApiUrl||""===this._customApiUrl)&&(i=this._customApiUrl);const o=new Request(i+e,s);this._networkLayer.fetch(o).then(a.bind(this)).then(this._handleJson(e,t,r).bind(this)).catch(this._handleError(e,r).bind(this))}_createHeaders(e={}){const t=Object.assign({},E);this._overrideTenant&&(t.currentTenant=this._overrideTenant),this._overrideCountry&&(t.country=this._overrideCountry);const{locale:r}=window.__RML__ENV__.initData;t.language=r,t.locale=r;const{contentType:a,accept:s,additionalHeaders:i,data:n}=e;if(a&&(t["content-type"]=e.contentType),s&&(t.accept=e.accept),i)for(let e in i)i.hasOwnProperty(e)&&(t[e]=i[e]);this._configuratorId&&(t.configurator=this._configuratorId),t.token="03-"+window.btoa((new Date).toISOString()+";"+C+";"+E.apiKey);const o=new Headers(t);return n instanceof FormData&&o.delete("content-type"),o}_handleJson(e,t,r={}){return a=>{let s=null,i=null;"number"==typeof a&&(s=a);for(let e in a)"meta"!==e&&a.hasOwnProperty(e)&&(s=a[e],i=e);if("error"===i)return this._handleError(e,r)(new Error(JSON.stringify(s)));if(!s)throw new TypeError("RAPI returned empty JSON");if(Array.isArray(s))for(let e=0,a=s.length;e<a;e++)this._prepareData(s[e],t,r),this._prepareEmbeddedData(s[e],t,r);else this._prepareData(s,t,r),this._prepareEmbeddedData(s,t,r);r.resolve?r.resolve(s):this._notifyWaiters(e,null,s)}}_prepareEmbeddedData(e,t,r={}){r.embed&&Array.isArray(r.embed)&&r.embed.forEach(a=>{const s=e[a.slice(0,-1)+"Objects"];if(Array.isArray(s)){for(let e=0,t=s.length;e<t;e++)this._prepareData(s[e],a,r);this._prepareRelationalData(t,a,e.id,s)}else s&&(this._prepareData(s,a,r),this._prepareRelationalData(t,a,e.id,[s]))})}_getCache(e){return this._getCacheFrom(e,k)}_getErrorCache(e){return this._getCacheFrom(e,F)}_getCacheFrom(e,t){let r=t.get(e);return r||(t.set(e,new Map),r=t.get(e)),r}_setCache(e,t,r){r.set(e.toString(),t)}_prepareData(e,t,r=null){let a=this._getCache(t);const s=r&&r.cacheKey?e[r.cacheKey]:e.id;if(s||r&&r.id||"tenants/me"===t)if("tenants/me"!==t){{const t=s||r.id;this._setCache(t,e,a)}e[J]=t}else this._setCache(S,e,a);else"shortIds"!==t&&console.error("Can not cache because there is no ID!")}_getRelationsCacheFor(e,t,r){let a=D.get(t);if(!a){const s=new Map,i=new Map;i.set(r,void 0),s.set(e,i),D.set(t,s),a=D.get(t)}let s=a.get(e);if(!s){const t=new Map;t.set(r,void 0),a.set(e,t),s=a.get(e)}return s.get(r)}_prepareGroups(e){const t=e.group,r=e.id;let a=L.get(t);a||(L.set(t,[]),a=L.get(t)),-1===a.indexOf(r.toString())&&a.push(r.toString())}_handleError(e,t={}){return r=>{navigator.onLine?(r.rmlErrorCode=1,this._errorHandler.dispatch(1,[r])):(r.rmlErrorCode=0,this._errorHandler.dispatch(0,[r])),t.reject?t.reject(r):this._notifyWaiters(e,r,null)}}_getRelationData(e,t,r={}){const a=e.id,s=e[J],i=t.rapiPath;let n=this._getCache(i),o=this._getRelationsCacheFor(a.toString(),s,i),h=[];return o?(o.forEach(e=>h.push(n.get(e))),new Promise(e=>e(h))):navigator.onLine?new Promise((e,t)=>{this._get("/"+s+"/"+a+"/"+i,i,r).then(t=>{this._prepareRelationalData(s,i,a,t),e(t)},t)}):Promise.resolve([])}_prepareRelationalData(e,t,r,a){D.has(e)||D.set(e,new Map);let s=D.get(e);const i=r.toString();s.has(i)||s.set(i,new Map);let n=s.get(i),o=this._getCache(t),h=[];for(let e=0,t=a.length;e<t;e++){const t=a[e],r=t.id.toString();h.push(r),o.set(r,t)}n.set(t,h)}_notifyWaiters(e,t,r){const a=N.get(e);if(a&&a.length){for(let e=0,s=a.length;e<s;e++)t?a[e].reject(t):a[e].resolve(r);N.delete(e)}}_tenantMe(){return new Promise((e,t)=>{const r=this._getCache("tenants/me"),a=this._overrideTenant?this._overrideTenant:r.get(S);if(a)return e(a);this._fetchJson("/tenants/me","tenants/me",{resolve:t=>e(t),reject:t})})}getCurrentSkin(){return this._tenantMe().then(e=>this._getById(e.toString(),"tenants").then(e=>this._getById(e.skin.toString(),"skins")))}getPrices(e){return this._getByIds(e,"prices",{filterKey:"priceIds",cacheKey:"priceId"})}}e("f",V),m([_],V.prototype,"_formDataUtil",void 0),m([_],V.prototype,"_errorHandler",void 0),m([_],V.prototype,"_dataSyncer",void 0),m([_],V.prototype,"_networkLayer",void 0),m([_],V.prototype,"_localStorage",void 0);class K{constructor(e){this.waitingForMaterials=[],this._maxAnisotrophy=1,this._textureLoader=new THREE.TextureLoader,this._creator_=e,this._previewMaterial=new THREE.MeshStandardMaterial({color:l,roughness:g,metalness:p}),this._environmentLoader.setEnvMap(this._previewMaterial)}_generateGeometry(e,t,r,a,s){let i;if(e&&this._cacheHolder.geometryCache.has(e))i=this._cacheHolder.geometryCache.get(e);else{(i=new THREE.Geometry).faceVertexUvs=[],i.faceVertexUvs[0]=[];for(let e=0,r=t.length;e<r;e+=3)i.vertices.push(new THREE.Vector3(t[e]/1e3,t[e+2]/1e3,t[e+1]/-1e3));let n=0,o=0,h=0,c=0,l=0,g=0,p=0,d=0,u=0,m=0,_=[];for(let e=0,t=r.length;e<t;e+=3)h=e+1,c=e+2,l=3*r[o=e],g=3*r[h],p=3*r[c],_=[new THREE.Vector3(s[l],s[l+2],-1*s[l+1]),new THREE.Vector3(s[g],s[g+2],-1*s[g+1]),new THREE.Vector3(s[p],s[p+2],-1*s[p+1])],i.faces.push(new THREE.Face3(r[o],r[h],r[c],_)),d=2*r[o],u=2*r[h],m=2*r[c],i.faceVertexUvs[0][n]=[],i.faceVertexUvs[0][n][0]=new THREE.Vector2(a[d],a[d+1]),i.faceVertexUvs[0][n][1]=new THREE.Vector2(a[u],a[u+1]),i.faceVertexUvs[0][n][2]=new THREE.Vector2(a[m],a[m+1]),n++;e&&this._cacheHolder.geometryCache.set(e,i)}return i}changeMaterialOfMesh(e,t){e&&t?(e.material=t,e.material.transparent&&(e.receiveShadow=!1),e.material.needsUpdate=!0):console.warn("could not assign material to mesh",{mesh:e},{material:t})}_createMaterial(e,t,r,a,i){if(this._cacheHolder.materialCache.has(e))t();else if(e.startsWith("benchmarkMaterial")){let n=s(e),o=d(n,this._environmentLoader);this._loadBenchmarkTextures(n,o,a,i).then(t,r)}else this._rapiAccess.getMaterial(e).then(e=>{let s=d(e,this._environmentLoader);this._loadTextures(e,s,a,i).then(t,r)},r)}_loadBenchmarkTextures(e,t,r=1,a=1){return new Promise((s,n)=>{const o=i(e.id);u(this._dataSyncer.requestAsset(o.image,!0),o,t,this._maxAnisotrophy,r/(0===o.mmWidth?1:o.mmWidth),a/(0===o.mmHeight?1:o.mmHeight)).then(()=>{this._cacheHolder.materialCache.set(e.id,t),s()},n)})}_loadTextures(e,t,r=1,a=1){return new Promise((s,i)=>{this._rapiAccess.getTexturesOf(e).then(n=>{let o=[];n.forEach(e=>{o.push(u(this._dataSyncer.requestAsset(e.image,!0),e,t,this._maxAnisotrophy,r/(0===e.mmWidth?1:e.mmWidth),a/(0===e.mmHeight?1:e.mmHeight)))}),Promise.all(o).then(()=>{this._cacheHolder.materialCache.set(e.id,t),s()},i)}),(!e.textures||e.textures&&0===e.textures.length)&&(this._cacheHolder.materialCache.set(e.id,t),s())})}_loadMaterial(e,t,r){return new Promise((a,s)=>{this._singlePromiseFactory.create(6,e,(a,s)=>this._createMaterial(e,a,s,t,r)).then(()=>{setTimeout(()=>a(this._cacheHolder.materialCache.get(e)),0)},s)})}_assignMaterial(e,t){return this._cacheHolder.materialCache.has(t)?(this.changeMaterialOfMesh(e,this._cacheHolder.materialCache.get(t)),Promise.resolve()):new Promise((r,a)=>{this._loadMaterial(t).then(t=>{this.changeMaterialOfMesh(e,t),r()},a)})}set maxAnisotrophy(e){this._maxAnisotrophy=e}clear(){this._cacheHolder.clear()}_assignRGB(e,t){return new Promise((r,a)=>{let s,i="rbg"+JSON.stringify(t);this._cacheHolder.materialCache.has(i)?s=this._cacheHolder.materialCache.get(i):(s=new THREE.MeshStandardMaterial({color:t}),this._environmentLoader.setEnvMap(s),this._cacheHolder.materialCache.set(i,s)),this.changeMaterialOfMesh(e,s),setTimeout(()=>r(),0)})}_assignItem(e,t){return new Promise((r,a)=>{if(this._cacheHolder.materialCache.has(t))return this.changeMaterialOfMesh(e,this._cacheHolder.materialCache.get(t)),void r();this._rapiAccess.getItem(t).then(s=>{if(s.topImage)this._textureLoader.load(s.topImage,a=>{a.anisotropy=this._maxAnisotrophy,a.wrapS=THREE.RepeatWrapping,a.wrapT=THREE.RepeatWrapping;let i=new THREE.Vector2(1,1);s.width>0&&(i.x=1/s.width),s.depth>0&&(i.y=1/s.depth),a.repeat.set(i.x,i.y);const n=new THREE.MeshPhysicalMaterial({map:a,roughness:.5,metalness:.1});this._environmentLoader.setEnvMap(n),this._cacheHolder.materialCache.set(t,n),this.changeMaterialOfMesh(e,n),setTimeout(()=>r(),0)});else{const e="can not set material, catalog item top image is not set";console.warn(e),a(e)}},a)})}_generateMesh(e=0,t=null,r,a,s,i,n,o=!1){return this._plannerMeshGenerator.generateMesh(t,r,a,s,i,n)}setMaterialLoadedListener(e){this._materialLoaded=e}removeMaterialLoadedListener(){this._materialLoaded=void 0}}e("h",K),m([_],K.prototype,"_rapiAccess",void 0),m([_],K.prototype,"_environmentLoader",void 0),m([_],K.prototype,"_dataSyncer",void 0),m([_],K.prototype,"_singlePromiseFactory",void 0),m([_],K.prototype,"_cacheHolder",void 0),m([_],K.prototype,"_plannerMeshGenerator",void 0);const W="on",Q="_isMute";class q{constructor(e){return this._isMute=!1,this._creator_=e,n(this,Q,{enumerable:!1,writable:!1}),n(q.prototype,"_setMute",{enumerable:!1,writable:!1}),n(q.prototype,"mute",{enumerable:!1,writable:!1}),n(q.prototype,"unmute",{enumerable:!1,writable:!1}),new Proxy(this,this)}_setMute(e){o(this,Q,!0),this._isMute=e,o(this,Q,!1)}mute(){this._setMute(!0)}unmute(){this._setMute(!1)}get(e,t){return this._isMute&&"function"==typeof this[t]&&t.substr(0,2)===W?()=>void 0:this[t]}}e("e",q)}}});
//# sourceMappingURL=chunk-d1691157.legacy.js.map
