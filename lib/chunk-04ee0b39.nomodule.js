System.register(["./chunk-ea0824e0.nomodule.js","./chunk-ec9039a8.nomodule.js","./chunk-5f398f9a.nomodule.js","./chunk-a25ce9e6.nomodule.js","./chunk-c5499f53.nomodule.js","./chunk-1f93c642.nomodule.js"],function(e,t){var a,i,r,s,n,o,l,h,d,_,m,c,p,u,g,M,w,f,y,C,b,E,P;return{setters:[function(e){a=e.c},function(e){i=e.m,r=e.o,s=e.k,n=e.K,o=e.a4,l=e.t,h=e.x,d=e.z,_=e.B,m=e.y,c=e.h,p=e.a5,u=e.E,g=e.F,M=e.a},function(e){w=e.a,f=e.b},function(e){y=e.d,C=e.e},function(e){b=e.a,E=e.b},function(e){P=e.a}],execute:function(){const t={x:1,y:1,z:1};class S extends P{constructor(e,t){super(e,t,i.RMV,"3D",!1),this._sceneParams={type:"cube"},this._materialParams={color:"#ffffff",metallic:.5,alpha:0,alphaCutoff:0,doubleSided:!1},this._lightSetting=new b(this._scene),this._initScene()}_initScene(){let e=new THREE.BoxGeometry(t.x,t.y,t.z,100,100,100);if(this._setMaterial(new THREE.MeshPhysicalMaterial({color:a().PRIMARY})),this._mesh=new THREE.Mesh(e,this._material),this._mesh.castShadow=!0,this._mesh.position.setY(t.y/2),this._scene.add(this._mesh),this._environment=new r(this._scene,null,new THREE.Color(16777215)),this._cameraControl instanceof s){const e=new THREE.Box3;e.setFromObject(this._mesh);let{x:t,y:a}=this._domHelper.getClientDimensions();this._cameraControl.updateAndReset(e.getSize(new THREE.Vector3),t,a,e.getCenter(new THREE.Vector3))}this.showGUI()}loadMaterialId(e){return new Promise(a=>{this._configuratorMeshGenerator.loadMaterial(e,100*t.x,100*t.y).then(e=>{this._setMaterial(e),this._mesh.material=this._material,this._updateGUI(),this._requestRender(!0),a()})})}loadMaterial(e){return new Promise(a=>{e.__rapi_path__||(e.__rapi_path__="materials"),this._setMaterial(n(e,this._environmentLoader.getEnvironmentMap())),this._mesh.material=this._material,this._configuratorMeshGenerator.loadTextures(e,this._material,100*t.x,100*t.y).then(()=>{this._updateGUI(),this._requestRender(!0)}),a()})}loadMaterialShading(e){return new Promise(t=>{let a={shading:e};this._setMaterial(n(a,this._environmentLoader.getEnvironmentMap())),this._mesh.material=this._material,this._updateGUI(),this._requestRender(!0),t()})}_setMaterial(e){this._material=e,this._materialParams.alpha=e.opacity,this._materialParams.alphaCutoff=e.alphaTest,this._materialParams.color="#"+e.color.getHexString(),this._materialParams.doubleSided=e.side===THREE.DoubleSide,this._materialParams.metallic=1===e.metalness?1:e.reflectivity}getMaterialShading(){return o(this._material)}createCameraControl(e){this._cameraControl=new s(this._creator_,this._getInputManager(),new THREE.Vector3(-1,1,1))}_getInputManager(){return this._inputManager}sceneChanged(){}getPixotronParams(){return{saoparams:{intensity:.25,occlusionWorldRadius:.6,smoothTransition:!0,samplesPerFrame:4,bias:.02,numSamples:200,accumulative:!0},shadowparams:{shadowMapResolution:1024,shadowRadius:1,shadowQuality:1,smoothTransition:!0,enableAccumulation:!0,shadowBiasMultiplier:.05,nearPlane:.01,farPlane:50,fov:40,numSamples:50,side:THREE.FrontSide},groundShadow:{enable:!1,smoothTransition:!0,numSamples:500,numSamplesPerFrame:4,onComplete:this._addGroundShadows.bind(this)}}}_guiLoaded(){this._updateGUI()}_updateGUI(){let e=l();this._guiGeometryFolder||(this._guiGeometryFolder=e.addFolder("Geometry"),this._guiGeometryFolder.add(this._sceneParams,"type",{Cube:"cube",Sphere:"sphere",PlaneVertical:"plane_v",PlaneHorizontal:"plane_h"}).onChange(e=>{this._setGeometry()})),this._material&&(this._guiMaterialFolder&&e.removeFolder(this._guiMaterialFolder),this._guiMaterialFolder=e.addFolder("Material"),this._guiMaterialFolder.addColor(this._materialParams,"color").onChange(e=>{this._material.color=new THREE.Color(e),this._shadingChanged()}),this._guiMaterialFolder.add(this._materialParams,"metallic").min(0).max(1).step(.01).onChange(e=>{this._material.metalness=1===e?1:.5,this._material.reflectivity=e||.5,this._shadingChanged()}),this._guiMaterialFolder.add(this._material,"roughness").min(0).max(1).step(.01).onChange(e=>{this._shadingChanged()}),this._guiMaterialFolder.add(this._materialParams,"alpha").min(0).max(1).step(.01).onChange(e=>{this._material.transparent=e<1,this._material.opacity=e,this._material.depthWrite=e>=1,this._shadingChanged()}),this._guiMaterialFolder.add(this._materialParams,"alphaCutoff").min(0).max(1).step(.01).onChange(e=>{this._material.alphaTest=e||0,this._shadingChanged()}),this._guiMaterialFolder.add(this._materialParams,"doubleSided").onChange(e=>{this._material.side=e?THREE.DoubleSide:THREE.FrontSide,this._shadingChanged()})),this._addGUIListener(e)}_shadingChanged(){this._roomleMaterialViewerUiCallback.onMaterialShadingChanged(o(this._material))}_setGeometry(){let e;"cube"===this._sceneParams.type&&(e=new THREE.BoxGeometry(t.x,t.y,t.z,100,100,100)),"sphere"===this._sceneParams.type&&(e=new THREE.SphereGeometry(.5,100,100)),"plane_h"===this._sceneParams.type&&(e=new THREE.PlaneGeometry(t.x,t.z)).rotateX(-Math.PI/2),"plane_v"===this._sceneParams.type&&(e=new THREE.PlaneGeometry(t.x,t.z)),this._mesh.geometry=e,this._requestRender(!0)}}w([f],S.prototype,"_inputManager",void 0),w([f],S.prototype,"_environmentLoader",void 0),w([f],S.prototype,"_configuratorMeshGenerator",void 0),w([f],S.prototype,"_roomleMaterialViewerUiCallback",void 0);class R{constructor(e){this._creator_=e}init(e){return this._domHelper.setDomElement(e),this._sceneManager?(this._lifeCycleManager.resume(),Promise.resolve()):new Promise(this._initPromiseCallback.bind(this))}_initPromiseCallback(e,t){this._threeLoader.fetch().then(()=>{let t=this._scriptLoader.fetch("static/three/lib/loaders/GLTFLoader.js",{id:"gltf-loader"}),a=this._scriptLoader.fetch("static/three/Tween.js",{id:"tween-js"});Promise.all([t,a]).then(()=>{this._sceneManager=new S(this._creator_,{left:0,top:1,right:1,bottom:0}),this.enableHD(),e()})})}enableHD(){return new Promise((e,t)=>{const a=()=>{this._sceneManager.enableHD(),e()};Promise.all([this._scriptLoader.fetch("static/three/lib/postprocessing/EffectComposer.js",{id:"effect-composer-js"}),this._scriptLoader.fetch("static/three/lib/lights/RectAreaLightUniformsLib.js",{id:"rect-area-light-uniforms-lib-js"}),this._scriptLoader.fetch("static/three/lib/postprocessing/ShaderPass.js",{id:"shader-pass-js"}),this._scriptLoader.fetch("static/three/lib/postprocessing/RenderPass.js",{id:"render-pass-js"}),this._scriptLoader.fetch("static/three/lib/shaders/CopyShader.js",{id:"copy-shader-js"})]).then(()=>{this._scriptLoader.fetch("static/three/pi.min.js",{id:"pi-js"}).then(a,t)},t)})}get callbacks(){return this._roomleMaterialViewerUiCallback}set callbacks(e){this._roomleMaterialViewerUiCallback=e}loadMaterialShading(e){return this._sceneManager.loadMaterialShading(e)}loadMaterial(e){return this._sceneManager.loadMaterial(e)}loadMaterialId(e){return this._sceneManager.loadMaterialId(e)}getMaterialShading(){return this._sceneManager.getMaterialShading()}loadSceneSetting(e){return this._sceneManager.loadSceneSettings(e)}loadQualitySetting(e){this._sceneManager.loadQualitySetting(e)}setOverrides(e){if(!e)return;const t=Object.assign(window.__RML__ENV__.initData,e);window.__RML__ENV__.initData=t}updateSize(){this._sceneManager.updateCamera()}resumeTest(e){this._domHelper.setDomElement(e),this._lifeCycleManager.resume()}pauseTest(){this._lifeCycleManager.pause()}showGUI(){this._sceneManager.showGUI()}}w([f],R.prototype,"_domHelper",void 0),w([f],R.prototype,"_scriptLoader",void 0),w([f],R.prototype,"_lifeCycleManager",void 0),w([f],R.prototype,"_threeLoader",void 0),w([f],R.prototype,"_roomleMaterialViewerUiCallback",void 0);const v=[new h("script-loader",d),new h("dom-helper",_,1),new h("logger",m),new h("input-manager",c,1),new h("environment-loader",p),new h("configurator-mesh-generator",E),new h("rapi-access",C),new h("roomle-material-viewer-ui-callback",class extends y{constructor(e){super(e),this.onMaterialShadingChanged=(e=>void 0)}},1)];e("MaterialViewer",class extends u{setupGlobals(){}setupDependencies(){g.setup(v),this._context=g.getContext("glb-viewer"),this.lookup("logger",this._context)}cleanUpGlobals(){throw new Error("Method not implemented.")}cleanUpDependencies(){throw new Error("Method not implemented.")}constructor(){super(),M.start("loadingTime")}bootFinished(){this._viewer=new R(this._context),window.RoomleMaterialViewer||(window.RoomleMaterialViewer=this._viewer)}getApi(){return this._viewer}})}}});
//# sourceMappingURL=chunk-04ee0b39.nomodule.js.map
